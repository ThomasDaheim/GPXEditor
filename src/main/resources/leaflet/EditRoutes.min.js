myMap.editTools=new L.Editable(myMap,{editable:!0});var tooltip=document.createElement("div");tooltip.style.cssText="display: none; position: absolute; background: #666; color: white; padding: 10px; border: 1px dashed #999; font-family: sans-serif; font-size: 12px; height: 20px; line-height: 20px; z-index: 1000;";document.body.appendChild(tooltip);
function addTooltip(b){L.DomEvent.on(document,"mousemove",moveTooltip);tooltip.innerHTML="Click on the map to start a new route.";tooltip.style.display="block"}function removeTooltip(b){tooltip.innerHTML="";tooltip.style.display="none";L.DomEvent.off(document,"mousemove",moveTooltip)}function moveTooltip(b){tooltip.style.left=b.clientX+20+"px";tooltip.style.top=b.clientY-10+"px"}
function updateTooltip(b){tooltip.innerHTML=b.layer.editor._drawnLatLngs.length<b.layer.editor.MIN_VERTEX?"Click on the map to continue the route.":"Click on last point to finish the route."}myMap.on("editable:drawing:start",addTooltip);myMap.on("editable:drawing:end",removeTooltip);myMap.on("editable:drawing:click",updateTooltip);
function makeEditable(b){var c=window[b];c.enableEdit();c.on("editable:drawing:end",function(a){a=c.getLatLngs();jscallback.updateRoute("editable:drawing:end",b,coordsToString(a))});c.on("editable:vertex:dragend",function(a){a=c.getLatLngs();jscallback.updateRoute("editable:vertex:dragend",b,coordsToString(a))});c.on("editable:vertex:deleted",function(a){c.closeTooltip();a=c.getLatLngs();jscallback.updateRoute("editable:vertex:deleted",b,coordsToString(a))});c.on("editable:vertex:new",function(a){a=
c.getLatLngs();jscallback.updateRoute("editable:vertex:new",b,coordsToString(a))});c.on("editable:vertex:mouseover",function(a){a=a.latlng;jscallback.registerRoute(b,a.lat,a.lng);c.openTooltip(a)});c.on("editable:vertex:mouseout",function(a){a=a.latlng;jscallback.deregisterRoute(b,a.lat,a.lng);c.closeTooltip()})};