L.Control.MapCenterCoord=L.Control.extend({options:{position:"bottomleft",icon:!0,onMove:!1,template:"{y} | {x}",projected:!1,formatProjected:"#.##0,000",latlngFormat:"DD",latlngDesignators:!1,latLngFormatter:void 0},onAdd:function(a){this.options.icon&&(this._iconEl=L.DomUtil.create("div","leaflet-control-mapcentercoord-icon leaflet-zoom-hide"),a.getPanes().overlayPane.appendChild(this._iconEl),a.on("viewreset",this._onReset,this),this._onReset());this._container=L.DomUtil.create("div","leaflet-control-mapcentercoord");
L.DomEvent.disableClickPropagation(this._container);a.on("move",this._onMapMove,this);a.on("moveend",this._onMapMoveEnd,this);this._container.innerHTML=this._getMapCenterCoord();return this._container},onRemove:function(a){this.options.icon&&(a.getPanes().overlayPane.removeChild(this._iconEl),a.off("viewreset",this._onReset,this));a.off("move",this._onMapMove,this);a.off("moveend",this._onMapMove,this)},_onReset:function(a){a=this._map.latLngToLayerPoint(this._map.getCenter());L.DomUtil.setPosition(this._iconEl,
a)},_onMapMove:function(a){this.options.icon&&(a=this._map.latLngToLayerPoint(this._map.getCenter()),L.DomUtil.setPosition(this._iconEl,a));this.options.onMove&&(this._container.innerHTML=this._getMapCenterCoord())},_onMapMoveEnd:function(a){this.options.icon&&(a=this._map.latLngToLayerPoint(this._map.getCenter()),L.DomUtil.setPosition(this._iconEl,a));this._container.innerHTML=this._getMapCenterCoord()},_getMapCenterCoord:function(){return this.options.projected?this._getProjectedCoord(this._map.options.crs.project(this._map.getCenter())):
this._getLatLngCoord(this._map.getCenter())},_getProjectedCoord:function(a){return L.Util.template(this.options.template,{x:this._format(this.options.formatProjected,a.x),y:this._format(this.options.formatProjected,a.y)})},_getLatLngCoord:function(a){if(void 0!=this.options.latLngFormatter)return this.options.latLngFormatter(a.lat,a.lng);var b=a.lat;var d=a.lng;0>d?(a=!0,d=Math.abs(d)):a=!1;if(0>b){var f=!0;b=Math.abs(b)}else f=!1;180<d&&(d=360-d,a=!a);if("DM"===this.options.latlngFormat){var e=parseInt(d);
d=e+"\u00ba "+this._format("00.000",60*(d-e))+"'";e=parseInt(b);b=e+"\u00ba "+this._format("00.000",60*(b-e))+"'"}else if("DMS"===this.options.latlngFormat){e=parseInt(d);var c=60*(d-e);d=e+"\u00ba "+this._format("00",parseInt(c))+"' "+this._format("00.0",60*(c-parseInt(c)))+"''";e=parseInt(b);c=60*(b-e);b=e+"\u00ba "+this._format("00",parseInt(c))+"' "+this._format("00.0",60*(c-parseInt(c)))+"''"}else d=this._format("#0.00000",d)+"\u00ba",b=this._format("##0.00000",b)+"\u00ba";return L.Util.template(this.options.template,
{x:(!this.options.latlngDesignators&&a?"-":"")+d+(this.options.latlngDesignators?a?" W":" E":""),y:(!this.options.latlngDesignators&&f?"-":"")+b+(this.options.latlngDesignators?f?" S":" N":"")})},_format:function(a,b){if(!a||isNaN(+b))return b;b="-"==a.charAt(0)?-b:+b;var d=0>b?b=-b:0,f=a.match(/[^\d\-\+#]/g),e=f&&f[f.length-1]||".";f=f&&f[1]&&f[0]||",";a=a.split(e);b=b.toFixed(a[1]&&a[1].length);b=+b+"";var c=a[1]&&a[1].lastIndexOf("0"),g=b.split(".");if(!g[1]||g[1]&&g[1].length<=c)b=(+b).toFixed(c+
1);c=a[0].split(f);a[0]=c.join("");var h=a[0]&&a[0].indexOf("0");if(-1<h)for(;g[0].length<a[0].length-h;)g[0]="0"+g[0];else 0==+g[0]&&(g[0]="");b=b.split(".");b[0]=g[0];if(g=c[1]&&c[c.length-1].length){c=b[0];h="";for(var m=c.length%g,k=0,l=c.length;k<l;k++)h+=c.charAt(k),!((k-m+1)%g)&&k<l-g&&(h+=f);b[0]=h}b[1]=a[1]&&b[1]?e+b[1]:"";return(d?"-":"")+b[0]+b[1]}});L.Map.mergeOptions({MapCenterCoordControl:!1});
L.Map.addInitHook(function(){this.options.MapCenterCoordControl&&(this.MapCenterCoordControl=new L.Control.MapCenterCoord,this.addControl(this.MapCenterCoordControl))});L.control.mapCenterCoord=function(a){return new L.Control.MapCenterCoord(a)};